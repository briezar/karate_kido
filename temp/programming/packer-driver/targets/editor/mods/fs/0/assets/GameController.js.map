{"version":3,"sources":["file:///D:/Cocos/Projects/Karate%20Chop/assets/GameController.ts"],"names":["_decorator","Component","Node","director","find","ProgressBar","PlayerMovement","ccclass","property","GameController","type","start","Instance","timerBar","getComponent","timer","maxTime","node","on","EventType","TOUCH_START","event","touchInput","getUILocation","isLost","isPaused","x","playerMovement","chopLeft","chopRight","window","sessionStorage","getItem","setItem","active","scheduleOnce","lose","loadScene","update","deltaTime","progress","knockAway"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAYC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;;AACnDC,MAAAA,c,iBAAAA,c;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;gCAGaS,c,WADZF,OAAO,CAAC,gBAAD,C,UAKHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI;AAAA;AAAA;AAAN,OAAD,C,8CALb,MACaD,cADb,SACoCR,SADpC,CAC8C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,2CASxB,CATwB;;AAAA;;AAAA,0CAYxB,KAZwB;;AAAA,4CAatB,KAbsB;AAAA;;AAe1CU,QAAAA,KAAK,GAAG;AACJF,UAAAA,cAAc,CAACG,QAAf,GAA0B,IAA1B;AAEA,eAAKC,QAAL,GAAgBT,IAAI,CAAC,cAAD,CAAJ,CAAqBU,YAArB,CAAkCT,WAAlC,CAAhB;AACA,eAAKU,KAAL,GAAa,KAAKC,OAAlB;AAEA,eAAKC,IAAL,CAAUC,EAAV,CAAahB,IAAI,CAACiB,SAAL,CAAeC,WAA5B,EAA0CC,KAAD,IAAgB;AACrD,iBAAKC,UAAL,GAAkBD,KAAK,CAACE,aAAN,EAAlB;AAEA,gBAAI,KAAKC,MAAL,IAAe,KAAKC,QAAxB,EAAkC;;AAElC,gBAAI,KAAKH,UAAL,CAAgBI,CAAhB,GAAoB,OAAO,CAA/B,EAAkC;AAC9B,mBAAKC,cAAL,CAAoBC,QAApB;AACH,aAFD,MAGK;AACD,mBAAKD,cAAL,CAAoBE,SAApB;AACH;AACJ,WAXD,EAWG,IAXH;;AAaA,cAAIC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,iBAA9B,KAAoD,IAAxD,EAA8D;AAC1DF,YAAAA,MAAM,CAACC,cAAP,CAAsBE,OAAtB,CAA8B,iBAA9B,EAAiD,QAAjD;AACA,iBAAKR,QAAL,GAAgB,IAAhB;AACA,iBAAKZ,QAAL,CAAcI,IAAd,CAAmBiB,MAAnB,GAA4B,KAA5B;AACA,gBAAIjB,IAAI,GAAGb,IAAI,CAAC,oBAAD,CAAf;AACAa,YAAAA,IAAI,CAACiB,MAAL,GAAc,IAAd;AAEA,iBAAKC,YAAL,CAAkB,MAAM;AACpBlB,cAAAA,IAAI,CAACiB,MAAL,GAAc,KAAd;AACA,mBAAKrB,QAAL,CAAcI,IAAd,CAAmBiB,MAAnB,GAA4B,IAA5B;AACA,mBAAKT,QAAL,GAAgB,KAAhB;AACH,aAJD,EAIG,CAJH;AAKH;AAEJ;;AAEDW,QAAAA,IAAI,GAAG;AACH,eAAKZ,MAAL,GAAc,IAAd;AAEA,eAAKW,YAAL,CAAkB,MAAM;AACpBhC,YAAAA,QAAQ,CAACkC,SAAT,CAAmB,OAAnB;AAEH,WAHD,EAGG,CAHH;AAIH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAI,KAAKd,QAAT,EAAmB;AAEnB,eAAKZ,QAAL,CAAc2B,QAAd,GAAyB,KAAKzB,KAAL,GAAa,KAAKC,OAA3C;;AAEA,cAAI,KAAKD,KAAL,IAAc,CAAd,IAAmB,CAAC,KAAKS,MAA7B,EAAqC;AACjC,iBAAKG,cAAL,CAAoBc,SAApB;AACA,iBAAKL,IAAL;AACH,WAHD,MAIK;AACD,iBAAKrB,KAAL,IAAcwB,SAAd;AACH;AACJ;;AAvEyC,O,uCAED,I;;;;;;AAwE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\nimport { _decorator, Component, Node, Vec2, director, find, ProgressBar, game } from 'cc';\nimport { PlayerMovement } from './PlayerMovement';\r\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = GameController\n * DateTime = Mon Feb 14 2022 15:51:20 GMT+0700 (Indochina Time)\n * Author = briezar\n * FileBasename = GameController.ts\n * FileBasenameNoExtension = GameController\n * URL = db://assets/GameController.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\n *\n */\n\n@ccclass('GameController')\nexport class GameController extends Component {\n\n    public static Instance: GameController = null;\n\n    @property({ type: PlayerMovement })\n    public playerMovement: PlayerMovement;\n\n    timerBar: ProgressBar;\n    timer: number;\n    maxTime: number = 6;\n\n    touchInput: Vec2;\n    isLost: boolean = false;\n    isPaused: boolean = false;\n\n    start() {\n        GameController.Instance = this;\n\n        this.timerBar = find(\"Canvas/Timer\").getComponent(ProgressBar);\n        this.timer = this.maxTime;\n\n        this.node.on(Node.EventType.TOUCH_START, (event: any) => {\n            this.touchInput = event.getUILocation();\n\n            if (this.isLost || this.isPaused) return;\r\n\n            if (this.touchInput.x < 1080 / 2) {\r\n                this.playerMovement.chopLeft();\r\n            }\r\n            else {\r\n                this.playerMovement.chopRight();\r\n            }\n        }, this);\n\n        if (window.sessionStorage.getItem('showInstruction') == null) {\r\n            window.sessionStorage.setItem('showInstruction', 'showed');\n            this.isPaused = true;\n            this.timerBar.node.active = false;\r\n            let node = find(\"Canvas/Instruction\");\r\n            node.active = true;\r\n\r\n            this.scheduleOnce(() => {\n                node.active = false;\r\n                this.timerBar.node.active = true;\r\n                this.isPaused = false;\r\n            }, 2);\r\n        }\r\n\r\n    }\n\n    lose() {\n        this.isLost = true;\n\n        this.scheduleOnce(() => {\r\n            director.loadScene(\"scene\");\r\n\r\n        }, 2);\r\n    }\n\n    update(deltaTime: number) {\n        if (this.isPaused) return;\n\n        this.timerBar.progress = this.timer / this.maxTime;\n\n        if (this.timer <= 0 && !this.isLost) {\r\n            this.playerMovement.knockAway();\r\n            this.lose();\r\n        }\n        else {\n            this.timer -= deltaTime;\n        }\r\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}