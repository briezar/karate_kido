{"version":3,"sources":["file:///D:/Cocos/Projects/Karate%20Chop/assets/PlayerMovement.ts"],"names":["_decorator","Component","systemEvent","SystemEventType","KeyCode","resources","SpriteFrame","Sprite","RigidBody2D","Vec2","UITransform","randomRange","GameController","SoundManager","TreeManager","ccclass","property","PlayerMovement","type","start","on","KEY_DOWN","onKeyDown","distanceFromTree","Math","abs","node","position","x","treeManager","playerMovement","load","err","spriteFrame","spriteArray","push","event","Instance","isLost","isPaused","keyCode","ARROW_LEFT","KEY_A","chopLeft","ARROW_RIGHT","KEY_D","chopRight","setScale","setPosition","y","chopTree","playChopAnimation","knockDown","scheduleOnce","getComponent","linearVelocity","playSound","bonkSound","knockAway","punchSound","anchorX","anchorY","angularVelocity","scale","unschedule","stopChopAnimation"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, systemEvent, SystemEventType, EventKeyboard, KeyCode, Vec3, resources, Asset, SpriteFrame, Sprite, Scheduler, RigidBody2D, Vec2, UITransform, random, randomRange, ERigidBody2DType } from 'cc';\nimport { GameController } from './GameController';\r\nimport { SoundManager } from './SoundManager';\r\nimport { TreeManager } from './TreeManager';\r\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = PlayerMovement\n * DateTime = Thu Feb 10 2022 22:37:08 GMT+0700 (Indochina Time)\n * Author = briezar\n * FileBasename = PlayerMovement.ts\n * FileBasenameNoExtension = PlayerMovement\n * URL = db://assets/PlayerMovement.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\n *\n */\n\n@ccclass('PlayerMovement')\nexport class PlayerMovement extends Component {\n    @property({ type: TreeManager })\n    public treeManager: TreeManager;\n\n    distanceFromTree: number;\n\n    //Player is on the left when scale.x = -1;\n    spriteArray: SpriteFrame[] = [];\n\n    start() {\n        systemEvent.on(SystemEventType.KEY_DOWN, this.onKeyDown, this);\n        this.distanceFromTree = Math.abs(this.node.position.x);\n        //this.playerFlipPoint = this.node.parent;\n        this.treeManager.playerMovement = this;\n\n        resources.load(\"lumberjackflip_0/spriteFrame\", SpriteFrame, (err, spriteFrame) => {\r\n            this.spriteArray.push(spriteFrame);\r\n        });\n\n        resources.load(\"lumberjackflip_1/spriteFrame\", SpriteFrame, (err, spriteFrame) => {\r\n            this.spriteArray.push(spriteFrame);\r\n        });\n\n    }\n\n    onKeyDown(event: EventKeyboard) {\n        if (GameController.Instance.isLost || GameController.Instance.isPaused) return;\r\n\n        switch (event.keyCode) {\n            case KeyCode.ARROW_LEFT:\n            case KeyCode.KEY_A:\n                this.chopLeft();\n                break;\n            case KeyCode.ARROW_RIGHT:\n            case KeyCode.KEY_D:\n                this.chopRight();\n                break;\n        }\n    }\r\n\r\n    chopRight() {\r\n        this.node.setScale(1, 1, 1);\r\n        this.node.setPosition(this.distanceFromTree, this.node.position.y, 0);\r\n        this.treeManager.chopTree();\r\n        this.playChopAnimation();\r\n    }\r\n\r\n    chopLeft() {\r\n        this.node.setScale(-1, 1, 1);\n        this.node.setPosition(-this.distanceFromTree, this.node.position.y, 0);\n        this.treeManager.chopTree();\r\n        this.playChopAnimation();\r\n    }\r\n\r\n\r\n    knockDown() {\r\n        this.scheduleOnce(() => {\r\n            this.getComponent(RigidBody2D).linearVelocity = new Vec2(0, -20);\r\n            SoundManager.Instance.playSound(SoundManager.Instance.bonkSound);\r\n        }, 0.1);\r\n    }\r\n\r\n    knockAway() {\r\n        SoundManager.Instance.playSound(SoundManager.Instance.punchSound);\r\n        this.getComponent(UITransform).anchorX = 0.5;\r\n        this.getComponent(UITransform).anchorY = 0.5;\r\n        this.getComponent(RigidBody2D).angularVelocity = this.node.scale.x * 60;\r\n        this.getComponent(RigidBody2D).linearVelocity = new Vec2(this.node.scale.x * 40, randomRange(15, 20));\r\n\r\n    }\r\n\r\n    playChopAnimation() {\r\n        this.unschedule(this.stopChopAnimation);\r\n        this.getComponent(Sprite).spriteFrame = this.spriteArray[0];\r\n        this.scheduleOnce(() => {\r\n            this.getComponent(Sprite).spriteFrame = this.spriteArray[1];\r\n        }, 0.05);\r\n\r\n        this.scheduleOnce(this.stopChopAnimation, 0.2);\r\n    }\r\n\r\n    stopChopAnimation() {\r\n        this.getComponent(Sprite).spriteFrame = this.spriteArray[0];\r\n    }\r\n\n    //update (deltaTime: number) {\n\n    //}\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}